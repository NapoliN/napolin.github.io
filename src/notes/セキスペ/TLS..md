---
title: セキスペ入門 TLS
tags: 
 - セキスペ
date: 2025/10/20
---


# TLSメモ
RFC5246参照
DHE鍵交換によってプリマスタシークレットを生成
平文で交換したランダム値(クライアント/サーバランダム)を結合してPRF(Pseudo Random Function)に通す
→ マスタシークレット
マスタシークレットを次の4つに分割する
- クライアント -> サーバ暗号鍵
- サーバ -> クライアント暗号鍵
- クライアント -> サーバ HMAC鍵
- サーバ -> クライアント HMAC鍵

## バージョン
| バージョン | 発行年 | RFC | 備考 |
|---|---|---|---|
| SSL 3.0 | 1996 | - | POODLE攻撃に脆弱であるため、使用禁止 |
| TLS 1.0 | 1999 | RFC2246 | BEAST攻撃に脆弱であるため、多くの場合廃止されている |
| TLS 1.1 | 2006 | RFC 4346 | 短期間のうちにTLS1.2が登場したため、あまり普及しなかった |
| TLS 1.2 | 2008 | RFC 5246 | 現在も広く使われている |
| TLS 1.3 | 2018 | RFC 8446 | 最新版。多くの古い暗号スイートが廃止されている |

## 攻撃
### POODLE攻撃
Padding Oracle On Downgraded Legacy Encryption.
具体的な手法は別ページに記載した。

### Beast攻撃
Browser Exploit Against SSL/TLS.
具体的な手法は別ページに記載した。

### Bleichenbacher攻撃

### ROBOT 攻撃
Return Of Bleichenbacher's Oracle Threat.
前述のBleichenbacher攻撃の亜種。

### Lucky13攻撃
CBCモードの暗号化、かつMAC-then-encryptを使っている場合に有効な攻撃。
CBCモードのパディングの検証において、パディング成功時/失敗時で処理時間がわずかに異なることを利用する。
攻撃者は暗号文ブロックを改変しながら(選択暗号文攻撃)、処理時間の差を測定し、平文を1バイトずつ復元する。

統計的な情報に依存するため、10^5~10^7スケールの試行回数を要するのが特徴。
詳細な仕組みは要調査です

### Heartbleed攻撃
OpenSSLの脆弱性(CVE-2014-0160)。仕様上の問題ではなく、実装上のバグ。史上最悪の脆弱性の一つとされる。


## MAC
Message Authentication Code.
改ざん検知のために、メッセージに付加される短いビット列のこと。
送信者と受信者が共有する鍵を用いて計算するため、送信元の認証とメッセージの完全性を検証できる。

### CMAC
Cipher-based MAC.
ブロック暗号による暗号化で、暗号文の最後のブロックをMACとして利用する。
要調査かも

### HMAC
Hash-based MAC.RFC2104参照。
メッセージ＋鍵をハッシュ化してMACとする。
受信者は、受信したメッセージを同じ方法でハッシュ化し、MACを比較することで改ざんの有無を検証できる。
1. メッセージ+鍵 をハッシュ化
2. ハッシュ化した値 + 鍵 をハッシュ化

2回ハッシュにかけるのは、SHA-1、SHA-256などのハッシュ関数が伸長攻撃に対して脆弱なため。

