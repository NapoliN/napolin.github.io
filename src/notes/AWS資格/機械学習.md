---
title: AWS資格対策 機械学習編
tags:
  - 資格勉強
  - クラウド
date: 2026/1/23
---

# AWS資格対策 機械学習編
AI Practitioner(AIF-C01)とMachine Learning Associate(MLA-C01)のために。

# 機械学習モデル
入力→出力の関係を学習する方法

## 深層学習
### モデル
- 畳み込みニューラルネットワーク (CNN)
    - 画像認識に特化したモデル
    - 畳み込み層とプーリング層を使用して特徴抽出
- リカレントニューラルネットワーク (RNN)
    - 時系列データやシーケンスデータに適したモデル
    - LSTMやGRUなどの変種がある
- トランスフォーマー
    - 自然言語処理で広く使用されるモデル
    - 注意機構を利用して長距離依存関係を捉える
- WaveNet
    - 音声生成に特化したモデル
    - 畳み込み層を用いて高品質な音声を生成

### 学習
#### パラメータ
- エポック数
    - 学習データ全体を何回繰り返して学習するかを示す指標
    - 少なすぎると過小適合、 多すぎると過学習のリスク
- バッチサイズ
    - 一度にモデルに入力するデータの数
    - 大きいと計算効率が良くなるが、メモリ使用量が増加
    - 小さいとノイズが増えるが、汎化性能が向上する場合がある
- 学習率
    - モデルのパラメータを更新する際のステップサイズ
    - 大きすぎると発散、小さすぎると収束が遅くなる

#### 学習法
- Few-shot学習
    - 少数のサンプルから新しいタスクを学習する手法
    - 事前学習済みモデルを活用して、少ないデータで高精度な予測を実現
    - LLMなら、プロンプトに数例の入出力ペアを与えることで新しいタスクに対応
- One-shot学習
    - 1つのサンプルから新しいタスクを学習する手法
    - 類似度学習やメタラーニングを活用して、1つの例から一般化
- ゼロショット学習
    - 学習データに存在しないクラスやタスクに対して予測を行う手法
    - 事前学習済みモデルの知識を活用して、新しいタスクに対応
    - LLMなら、タスクの説明をプロンプトに与えることで対応

## フレームワーク
- TensorFlow
    - Googleが開発したオープンソースの深層学習フレームワーク
    - 大規模な分散学習に対応
- PyTorch
    - Facebookが開発したオープンソースの深層学習フレームワーク
    - 動的計算グラフを採用し、柔軟なモデル構築が可能
- MXNet
    - Amazonが支援するオープンソースの深層学習フレームワーク
    - スケーラブルで効率的な分散学習が可能

## 分類タスク
### 決定木
教師あり学習により特徴量に基づいてデータを分割し、木構造のモデルを構築するアルゴリズム。
#### 特徴領重要度
決定木モデルにおいて、各特徴量が予測に与える影響度を示す指標
### ランダムフォレスト
複数の決定木でアンサンブル学習を行って精度を高める学習アルゴリズム
#### バギング
単一のモデルを並列に学習して、予測を平均/多数決で決定する手法
過学習の回避に効果が高い
#### ブースティング
弱学習器を逐次的に学習させ、前モデルの結果を用いて徐々に制度を高めていく手法
e.g. **XGBoost** / LightGBM / CatBoost
#### スタッキング
複数のモデルを並列に学習させ、その出力を最終的なモデルに学習させる手法
#### 変数重要度
ランダムフォレストにおいて、各変数の重要度を調べる手法
### k近傍法
k個の近傍データから出力の予測を行う教師あり学習のモデル
回帰タスクにも利用できる

### 評価メトリクス
#### 混同行列
分類モデルの性能を評価するための表形式の指標
４つの要素から構成
- True Positive (TP): モデルが正例と予測し、実際に正例であるケースの数
- True Negative (TN): モデルが負例と予測し、実際に負例であるケースの数
- False Positive (FP): モデルが正例と予測したが、実際には負例であるケースの数 (タイプIエラー)
- False Negative (FN): モデルが負例と予測したが、実際には正例であるケースの数 (タイプIIエラー)
#### 適合率
モデルが正例と予測したデータのうち、実際に正例である割合を示す指標
- Precision = TP / (TP + FP)
#### 再現率
実際に正例であるデータのうち、モデルが正例と予測した割合を示す指標
- Recall = TP / (TP + FN)
#### 精度
モデルが正しく予測したデータの割合を示す指標
- Accuracy = (TP + TN) / (TP + TN + FP + FN)
#### F1スコア
適合率と再現率の調和平均を計算する指標
適合率と再現率がバランスよく要求される場合に有用
- F1 Score = 2 * (Precision * Recall) / (Precision + Recall)
#### Area Under the Curve (AUC)
二項分類モデルの性能を評価する指標
0から1の確率をかえし、スコアが1に近いほど優れたモデル

## 回帰タスク
### モデル
#### 線形回帰
連続値の予測に使用
入力特徴の線形結合で出力を予測

#### サポートベクタマシン
分類タスクにも使用される
マージン最大化に基づく分類境界を構築
### 評価メトリクス
#### 決定係数 (R²)
回帰モデルの予測精度を評価する指標
0から1の値を取り、1に近いほど良いモデル

#### 二乗平均誤差 (MSE)
回帰モデルの予測精度を評価する指標
予測値と実測値の差の二乗の平均を計算し、、小さいほど良いモデル
誤差が2乗されるので、大きな誤差に対して敏感

#### 二乗平均平方根誤差 (RMSE)
回帰モデルの予測精度を評価する指標
予測値と実測値の差の二乗平均の平方根を計算し、小さいほど良いモデル
単位が元のデータと同じになるため、解釈しやすい

#### 平均絶対誤差 (MAE)
回帰モデルの予測精度を評価する指標
予測値と実測値の差の絶対値の平均を計算し、小さいほど良いモデル

#### 汎化誤差
モデルが未知のデータに対してどれだけ正確に予測できるかを示す指標
訓練データに対する誤差と未知データに対する誤差の差分で評価

#### 部分依存プロット
モデルの予測に対する各特徴量の影響を視覚化する手法

## クラスタリング
### k平均法
データセットをk個のクラスタに分割する教師なし学習アルゴリズム

## 異常検知
### ランダムカットフォレスト
木構造を用いてデータ点の孤立のしやすさから異常を検知する教師なし学習アルゴリズム

### IP Insights
IPアドレスとエンティティの関係性を学習し、異常なアクセスパターンを検知する教師なし学習アルゴリズム

## 画像分類
### セグメンテーション
- セマンティックセグメンテーション
    - 画像内の各ピクセルにクラスラベルを割り当てるタスク
    - 例: 自動運転車における道路、歩行者、車両の識別
    - 主なモデル: U-Net, DeepLab, FCN (Fully Convolutional Networks)
    - 同じクラスならば同一視
- インスタンスセグメンテーション
    - 画像内の各オブジェクトインスタンスを識別し、区別するタスク
    - 例: 複数の人や物体を個別に識別
    - 主なモデル: Mask R-CNN, YOLACT
    - 全部を個別に識別
- パノプティックセグメンテーション
    - セマンティックセグメンテーションとインスタンスセグメンテーションを組み合わせたタスク
    - 画像内のすべてのピクセルに対して、クラスラベルとインスタンスIDを割り当てる
    - 例: 都市景観の解析で、道路や建物をセマンティックに識別しつつ、歩行者や車両を個別に識別
    - 主なモデル: Panoptic FPN, UPSNet
    - 背景含め、すべてのピクセルが判定対象

## 時系列予測
### RNN
時系列・系列データの依存関係を学習するニューラルネットワーク

### DeepAR
複数の関連する時系列データを同時にモデル化可能

### ARIMA
古典的な時系列予測アルゴリズム
自己回帰、移動平均、季節性を考慮

## 自然言語処理
### LLM
いわゆる生成AI
#### 検索拡張生成 (RAG)
大規模言語モデル (LLM) の生成能力と情報検索システムの正確性を組み合わせた手法
外部の知識から最新の情報を取得し、LLMの応答生成に活用

#### 制御パラメータ
- 温度
    - 主に生成モデルで使用されるパラメータ
    - 生成される出力の多様性を制御
    - 高い温度は多様な出力、低い温度は決定的な出力を生成
- トップK
    - 生成モデルで使用される手法
    - 出力候補の上位K個からランダムに選択して生成
    - 多様性を高める効果がある
- トップP (核サンプリング)
    - 生成モデルで使用される手法
    - 累積確率がPを超えるまでの候補からランダムに選択して生成
    - 多様性と品質のバランスを取る
- ペナルティ
    - 生成モデルで使用される手法
    - 既に生成されたトークンの再出現を抑制するために使用
    - 出力の多様性を向上させる効果がある

### 評価メトリクス
#### BLEUスコア
機械翻訳モデルの生成テキストと参照テキストの類似度を評価する指標
#### ROUGEスコア
テキスト要約モデルの評価を行うための指標
人間が作成した要約とモデルが生成した要約の重複するn-gramや文の数を基に評価
#### BERTスコア
自然言語処理モデルの生成テキストと参照テキストの類似度を評価する指標
BERTなどの事前学習済み言語モデルを使用して、文の意味的な類似度を計算
テキスト要約に適したスコア
#### RWKスコア
LLMベースのAIを使用した生成テキストの正解率を示すためのメトリクス
テキスト生成タスクに適したスコア

# 汎用知識
## ハイパーパラメータ
機械学習モデルの学習プロセスを制御するためユーザが設定する変数
NNでいうとノード・層の数、決定木の分岐数などがある
学習率、バッチサイズ、エポック数なども含まれる

### ハイパーパラメータ最適化
- ベイズ最適化
    - 過去の評価結果を基に次のハイパーパラメータを選択
- グリッドサーチ
    - 各ハイパーパラメータの候補値を網羅的に組み合わせて評価
    - 計算コストが高く、多数のハイパーパラメータでは非効率
- ランダムサーチ
    - ハイパーパラメータの候補値をランダムに選んで評価
    - ハイパーパラメータが少ないときに有効

## ドリフト
モデルを作ったときと現在の前提のズレ
### データドリフト
入力データの分布が変化すること
学習時の特徴領分布と推論時の特徴領分布が異なる場合
例: センサーのキャリブレーション変更、季節変動、ユーザー行動の変化
### コンセプトドリフト
予測対象の概念自体が変化すること
例: 製品の人気が変化する、詐欺の手法が進化する
入力データの分布が変わってなくても、正解が変わる場合がある
### ラベルドリフト
正解ラベルの分布が変化すること
例: あるクラスの事例が増加または減少する場合
### バイアスドリフト
データ収集やラベリングの過程で生じるバイアスが変化すること
例: 新しいデータソースの追加、ラベリング基準の変更
### データ品質ドリフト
データの品質が変化すること
例: センサーの故障、データ欠損、ノイズの増加

# AWSサービス
## インスタンス
- Trn1：深層学習トレーニング専用インスタンス
- Inf2 : 深層学習推論専用インスタンス
- G5 : GPU搭載汎用インスタンス、グラフィック集約アプリや機械学習の推論・学習など
- P5 : 深層学習・ハイパフォーマンスコンピューティング向けインスンタンス

## MLOps
MLのワークフロー・デプロイうを自動化・簡素化するプラクティス
以下の要素から構成される
- バージョン管理
- オートメーション
- 継続的X
    - 継続的インテグレーション (CI)
    - 継続的デリバリー (CD)
    - 継続的トレーニング (CT)
    - 継続的モニタリング
- モデルガバナンス
### 機械学習ライフサイクル
- ビジネス目標の策定
    - 成功の基準
    - ステークホルダーとの連携
- MLの問題を組み立てる
    - タスクの定義：入出力・メトリクス
    - 実現可能性
- データを収集
- データ処理
- モデルの開発
- デプロイ
- モニタリング
    - バイアス・ドリフトの検出


## 構築済みMLサービス
### Amazon Comprehend
自然言語処理 (NLP) サービスで、テキストから洞察や関係性を抽出
### Amazon Forecast
時系列予測サービスで、機械学習を活用して高精度な予測を提供
### Amazon Personalize
リアルタイムのパーソナライズドレコメンデーションを提供するサービス
### Amazon Rekognition
画像および動画分析サービスで、顔認識、物体検出、コンテンツモデレーションなどの機能を提供
### Amazon Textract
ドキュメントからテキストとデータを自動的に抽出するサービス
### Amazon Transcribe
音声をテキストに変換する自動音声認識 (ASR) サービス
### Amazon Polly
テキストを自然な音声に変換するテキスト読み上げサービス
### Amazon Fraud Detector
機械学習を活用してオンライン取引の不正行為を検出するサービス
### Amazon Monitron
産業機器の異常検知と予知保全を支援するサービス
### Amazon Lookout for Metorics
機械学習を活用してメトリクスの異常を自動的に検出するサービス
### Amazon Lookout for Equipment
機械学習を活用した産業機器の監視サービス
### Amazon Lookouit for Vision
機械学習を活用し、コンピュータビジョンを活用して製造業の製品欠陥を発見するためのサービス
### Amazon Panorama
機械学習ワークロード用に最適化され、ビデオストリームに対してリアルタイムで推論を実行可能
### AWS well-architected machine learning lens
機械学習ワークロードの設計と運用に関するベストプラクティスを提供するガイドライン
モデルの迅速な構築とデプロイなどのベストプラクティスの手法を示すガイドライン

## 構築済みAIサービス (Amazon Bedrock)
マネージド型のサービスで、複数の大規模言語モデル(LLM) プロバイダーからモデルを選択して利用可能
クミコミ/カスタムのプロンプトデータセットを使うことで、モデルの比較評価をして最適なモデルを特定できる
### ガードレール機能
Bedrockを使用する際の安全性と倫理性を確保するための出力の制御機能
- コンテンツフィルター
- プロンプト攻撃
- 拒否トピック
- ワードフィルター
- 機密情報フィルター
- コンテキストグラウンディングチェック
- 自動推論チェック

### ナレッジベース機能
情報のリポジトリとしてデータソースを統合し、RAGを活用することが可能
データを効率的に検索できるよう、インデックスを作成することが望ましい

### 自動不正検出機能
- コンテンツの分類
- パターンの特定
- 児童の性的虐待マテリアルの検出・ブロック

### モデル評価
Bedrockで利用可能な各大規模言語モデル(LLM)の性能を評価するための基準と手法
- 自動モデル評価：カスタマイズされたプロンプトデータセットや、組み込みデータセットを使用してモデルの応答を評価
- ヒューマンワーカーによる評価：人間の評価者が独誌のデータセットに対するモデルの応答をレビューし、品質、関連性、一貫性を評価
- 判定モデルを使用した評価：２つ目のLLMを判定モデルとして使用して、生成された応答の品質を自動的に評価
- ナレッジベース評価：ナレッジベースのパフォーマンスを評価

### 関連サービス
#### Bedrock Data Automation
飛行増加コンテンツから洞察を引き出すプロセスを効率化するツール
ドキュメント・画像などの日構造データを構造化された形式に変換し、ワークフローの自動化を支援する

#### Amazon Bedrock Flows
Bedrockの機能を活用し、コーディングなしでワークフローを構築
質問→分類→回答生成→要約、などのタスクのフローを事前定義することで、迅速にアプリケーションを開発可能

#### Amazon Bedrock Agent
エージェントベースのアプリケーションを構築するためのフレームワーク
- 外部APIやデータソースと連携して、複雑なタスクを実行可能
複数の専門エージェントを組み合わせて、複雑な問題を解決することも可能

### 対応するLLM基盤
- AI21Labs
- Anthropic
- Cohere
- Stability AI
- Amazon Titan
- Meta

## MLフレームワーク (SageMaker)
機械学習モデルの構築を行うことができるサービス
色んなアルゴリズムを利用してモデルを構築できる

### 利用可能なアルゴリズム
#### レコメンデーション
- Factorization Machines (FM)
    - レコメンデーションシステム向けのアルゴリズム
    - 大規模で疎なデータに対して効果的
- Neural Collaborative Filtering (NCF)
    - 深層学習に基づくレコメンデーションアルゴリズム
    - ユーザーとアイテムの非線形な関係をモデル化
#### 自然言語処理
- BlazingText
    - 単語埋め込みとテキスト分類に対応するアルゴリズム
    - Word2Vecの高速実装
- Seq2Seq
    - シーケンスからシーケンスへの変換タスクに対応
    - 機械翻訳や要約生成に使用
#### 画像処理
- Image Classification
    - 画像分類タスクに対応するアルゴリズム 
- Object Detection
    - 物体検出タスクに対応するアルゴリズム
- Semantic Segmentation
    - セマンティックセグメンテーションタスクに対応するアルゴリズム
- DeepLab v3
    - 高精度なセマンティックセグメンテーションアルゴリズム
    - 畳み込みニューラルネットワークに基づく

#### 強化学習
- Q Learning
    - 状態-行動価値関数を学習し、最適な行動を選択

### サービス
#### モデル構築のアシスト
##### Amazon SageMaker JumStart
画像処理・自然言語処理など複数のタイプの問題に対し、事前トレーニング済みモデルを提供
独自のデータセットを使用してファインチューニングすることが可能(転移学習)。
##### Amazon SageMaker AutoPilot
自動機械学習 (AutoML) サービスで、データセットから最適な機械学習モデルを自動的に構築、トレーニング、チューニングまでを自動で実行
##### Amazon SageMaker Studio
統合開発環境 (IDE) で、データサイエンスと機械学習のワークフローを効率化
##### Amazon SageMaker Canvas
コード不要でドラッグアンドドロップ操作により、機械学習モデルの構築と予測が可能なサービス
##### Amazon SageMaker Pipelines
機械学習ワークフローの自動化と管理を支援するサービス
- モデルのトレーニング、評価、デプロイメントの各ステップを定義可能
- 再利用可能なパイプラインコンポーネントを提供

#### データの収集・処理
トレーニングデータの収集・前処理、特徴領エンジニアリングを行うサービス
##### AWS Glue
サーバーレスのデータ統合サービスで、データの準備、変換、ロード（ETL）を自動化
Kinesis DataStreams -> Glue -> parquet変換 -> s3保存
##### AWS Glue DataBrew
ノーコードでデータのクリーニング/正規化を行うことができるツール
NULL値の削除、欠損値の置換などに用いることができる
##### Amazon SageMaker Ground Truth
データ収集とラベリングを自動化し、高品質なトレーニングデータセットを効率的に作成するサービス
- 人間のアノテーターと機械学習を組み合わせてラベリング作業を自動化
- 画像、テキスト、音声データのラベリングに対応
**Ground Truth Plus**を利用することで、AWSが提供するプロフェッショナルなアノテーターにラベリング作業をアウトソース可能

##### Amazon SageMaker Data Wrangler
データの準備と前処理を簡素化するサービス
- 300以上の組み込み変換を提供
- データの可視化と分析が可能
##### SageMaker Feature Store
特徴領の管理、再利用を行うためのサービス
オンラインストア
- 低レイテンシでリアルタイム推論に使用可能
- 高速な読み取りと書き込みが可能
- 推論に使う
- DynamoDBを基盤として構築
オフラインストア
- 大規模なバッチ処理や分析に使用可能
- 学習・分析に使う
- Amazon S3に保存され、AthenaやRedshift Spectrumでクエリ可能

オンデマンド
- アクセス量が読めない場合に適した料金モデル
プロビジョンド
- 一定のアクセス量が見込まれる場合に適した料金モデル

##### Amazon SageMaker Clarify
機械学習モデルのバイアス検出と説明可能性を向上させるサービス
- データセットとモデルのバイアスを評価

#### モデルの学習
トレーニング、チューニング、評価のサイクルを回すことによってモデルを最適化する
- 学習でパラメータの最適化
- チューニングでハイパーパラメータの最適化

##### Amazon SageMaker Training
以下の３つを指定してモデルの学習を行う
- 学習アルゴリズムが格納されているECRコンテナ
- 学習データが保存されているS3バケット
- 学習に使用するインスタンス

結果として得られるものを**モデルアーティファクト**と呼び、S3に保存される
##### Amazon SageMaker Automatic Model Tuning
ハイパーパラメータの最適な組み合わせを自動的に見つけるサービス
Area Under the Curveという指標を最大化・最小化するハイパーパラメータの組み合わせを探索
- グリッドサーチ、ランダムサーチ、ベイズ最適化をサポート
##### Amazon SageMaker Experiments
機械学習モデルのトレーニングジョブやハイパーパラメータチューニングジョブの管理と追跡を支援するサービス
ビジュアルインターフェイスで実験の参照、比較、分析が可能

#### デプロイ
バッチ推論、リアルタイム推論、エッジデバイスでの推論


##### Amazon SageMaker Model Monitor
デプロイされた機械学習モデルのパフォーマンスを継続的に監視するサービス
- データドリフトやモデルの精度低下を検出
- アラート設定と自動修正機能を提供

##### Amazon SageMaker Model Registry
機械学習モデルのバージョン一元管理とデプロイメントを支援
モデルやメタデータの追跡、バージョン比較などが可能

##### Amazon SageMaker Model Cards
機械学習モデルの透明性と説明責任を向上させるためのドキュメント
- モデルの性能、使用ケース、制限事項を明確に記述
- モデルの倫理的な使用を促進

#### 推論
##### Amazon SageMaker リアルタイムエンドポイント
低レイテンシでスケーラブルな機械学習モデルのデプロイを可能にするサービス

##### Amazon SageMaker サーバーレス推論
インフラ管理不要で、スケーラブルな機械学習モデルのデプロイを可能にするサービス
- トラフィックに応じて自動的にスケール
- 使用した分だけ課金される従量課金制
###### 指定できるパラメータ
- メモリサイズ
- 同時呼び出し数
- コールドスタートの最小化

### Amazon Quicksight
ビジネスインテリジェンス (BI) サービスで、データの可視化と分析を提供
- インタラクティブなダッシュボードの作成
- 機械学習を活用した洞察の提供
### Amazon Q
ダッシュボード作成など、BI機能を自然言語で操作できるAI駆動型のサービス
### Amazon Q Developper
ソフトウェアスニペットの生成、リファレンス、OSSの管理をサポートするAI駆動型の開発者アシスタント
### Amazon Q Bussiness
企業向けAIアシスタントの構築を支援するサービス
**Custom Data Source Connector**を活用して、外部データソースを用いることが可能
### Amazon Q Apps
組織内のデータを基に生成AIを活用したアプリケーションを作成するためのサービス

# 画像生成
- CFGスケール
    - 画像生成モデルにおける条件付けの強さを制御するパラメータ
    - 高い値は条件に厳密に従う画像を生成し、低い値は多様性のある画像を生成
- 生成ステップ数
    - 画像生成プロセスにおける反復回数を示すパラメータ
    - 多くのステップ数は高品質な画像を生成するが、計算コストが増加